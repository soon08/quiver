{
  "title": "50坑",
  "cells": [
    {
      "type": "text",
      "data": "<div class=\"blog-body\" id=\"blogBody\" style=\"box-sizing: inherit; font-size: 16px; font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; word-wrap: break-word; color: rgb(61, 70, 77); line-height: 28px; margin-top: 30px; position: relative; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(248, 248, 248);\"><div class=\"BlogContent\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">你可以使用纯一维数组、“独立”切片的切片，“共享数据”切片的切片来构建动态的多维数组。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">如果你使用纯一维的数组，你需要处理索引、边界检查、当数组需要变大时的内存重新分配。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">使用“独立”slice来创建一个动态的多维数组需要两步。首先，你需要创建一个外部的slice。然后，你需要分配每个内部的slice。内部的slice相互之间独立。你可以增加减少它们，而不会影响其他内部的slice。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    x := <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span>\n    y := <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">4</span>\n\n    table := <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">make</span>([][]<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>,x)\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> i:= <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">range</span> table {\n        table[i] = <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">make</span>([]<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>,y)\n    }\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">使用“共享数据”slice的slice来创建一个动态的多维数组需要三步。首先，你需要创建一个用于存放原始数据的数据“容器”。然后，你再创建外部的slice。最后，通过重新切片原始数据slice来初始化各个内部的slice。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    h, w := <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span>, <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">4</span>\n\n    raw := <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">make</span>([]<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>,h*w)\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> i := <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">range</span> raw {\n        raw[i] = i\n    }\n    fmt.Println(raw,&amp;raw[<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">4</span>])\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints: [0 1 2 3 4 5 6 7] &lt;ptr_addr_x&gt;</span>\n\n    table := <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">make</span>([][]<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>,h)\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> i:= <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">range</span> table {\n        table[i] = raw[i*w:i*w + w]\n    }\n\n    fmt.Println(table,&amp;table[<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>][<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>])\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints: [[0 1 2 3] [4 5 6 7]] &lt;ptr_addr_x&gt;</span>\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">关于多维array和slice已经有了专门申请，但现在看起来这是个低优先级的特性。</p><span id=\"OSC_h3_16\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_15\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">访问不存在的Map Keys</h3><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">-level: beginner</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">这对于那些希望得到“nil”标示符的开发者而言是个技巧（和其他语言中做的一样）。如果对应的数据类型的“零值”是“nil”，那返回的值将会是“nil”，但对于其他的数据类型是不一样的。检测对应的“零值”可以用于确定map中的记录是否存在，但这并不总是可信（比如，如果在二值的map中“零值”是false，这时你要怎么做）。检测给定map中的记录是否存在的最可信的方法是，通过map的访问操作，检查第二个返回的值。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Bad:</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    x := <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">map</span>[<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">string</span>]<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">string</span>{<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"one\"</span>:<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"a\"</span>,<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"two\"</span>:<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"\"</span>,<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"three\"</span>:<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"c\"</span>}\n\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">if</span> v := x[<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"two\"</span>]; v == <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"\"</span> { <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//incorrect</span>\n        fmt.Println(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"no entry\"</span>)\n    }\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Good:</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    x := <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">map</span>[<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">string</span>]<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">string</span>{<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"one\"</span>:<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"a\"</span>,<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"two\"</span>:<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"\"</span>,<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"three\"</span>:<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"c\"</span>}\n\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">if</span> _,ok := x[<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"two\"</span>]; !ok {\n        fmt.Println(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"no entry\"</span>)\n    }\n}</code></pre><span id=\"OSC_h3_17\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_16\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">Strings无法修改</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">尝试使用索引操作来更新字符串变量中的单个字符将会失败。string是只读的byte slice（和一些额外的属性）。如果你确实需要更新一个字符串，那么使用byte slice，并在需要时把它转换为string类型。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Fails:</p><pre class=\"hljs css\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs css\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> <span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">main</span>\n\n<span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> \"<span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">fmt</span>\"\n\n<span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">func</span> <span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">main</span>() {  \n    <span class=\"hljs-attribute\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 220, 188);\">x </span>:= <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"text\"</span>\n    x[<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>] = <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">'T'</span>\n\n    fmt.<span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">Println</span>(x)\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Compile Error:</p><pre class=\"hljs groovy\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs groovy\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-regexp\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">/tmp/</span>sandbox305565531/main.<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">go:</span><span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">7</span>: cannot assign to x[<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>]</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Works:</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    x := <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"text\"</span>\n    xbytes := []<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">byte</span>(x)\n    xbytes[<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>] = <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">'T'</span>\n\n    fmt.Println(<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">string</span>(xbytes)) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints Text</span>\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">需要注意的是：这并不是在文字string中更新字符的正确方式，因为给定的字符可能会存储在多个byte中。如果你确实需要更新一个文字string，先把它转换为一个rune slice。即使使用rune slice，单个字符也可能会占据多个rune，比如当你的字符有特定的重音符号时就是这种情况。这种复杂又模糊的“字符”本质是Go字符串使用byte序列表示的原因。</p><span id=\"OSC_h3_18\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_17\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">String和Byte Slice之间的转换</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">当你把一个字符串转换为一个byte slice（或者反之）时，你就得到了一个原始数据的完整拷贝。这和其他语言中cast操作不同，也和新的slice变量指向原始byte slice使用的相同数组时的重新slice操作不同。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Go在&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">[]byte</code>到&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">string</code>和&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">string</code>到&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">[]byte</code>的转换中确实使用了一些优化来避免额外的分配（在todo列表中有更多的优化）。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">第一个优化避免了当&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">[]byte</code>key用于在&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">map[string]</code>集合中查询时的额外分配:&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">m[string(key)]</code>。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">第二个优化避免了字符串转换为&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">[]byte</code>后在&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">for&nbsp;range</code>语句中的额外分配：&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">for&nbsp;i,v&nbsp;:=&nbsp;range[]byte(str)&nbsp;{...}</code>。</p><span id=\"OSC_h3_19\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_18\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">String和索引操作</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">字符串上的索引操作返回一个byte值，而不是一个字符（和其他语言中的做法一样）。</p><pre class=\"hljs css\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs css\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> <span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">main</span>\n\n<span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> \"<span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">fmt</span>\"\n\n<span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">func</span> <span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">main</span>() {  \n    <span class=\"hljs-attribute\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 220, 188);\">x </span>:= <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"text\"</span>\n    fmt.<span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">Println</span>(x[0]) //print <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">116</span>\n    fmt.<span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">Printf</span>(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"%T\"</span>,x[0]) //prints uint8\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">如果你需要访问特定的字符串“字符”（unicode编码的points/runes），使用&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">for&nbsp;range</code>。官方的“unicode/utf8”包和实验中的utf8string包（golang.org/x/exp/utf8string）也可以用。utf8string包中包含了一个很方便的&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">At()</code>方法。把字符串转换为rune的切片也是一个选项。</p><span id=\"OSC_h3_20\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_19\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">字符串不总是UTF8文本</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">字符串的值不需要是UTF8的文本。它们可以包含任意的字节。只有在string literal使用时，字符串才会是UTF8。即使之后它们可以使用转义序列来包含其他的数据。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">为了知道字符串是否是UTF8，你可以使用“unicode/utf8”包中的&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">ValidString()</code>函数。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> (  \n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"unicode/utf8\"</span>\n)\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    data1 := <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"ABC\"</span>\n    fmt.Println(utf8.ValidString(data1)) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints: true</span>\n\n    data2 := <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"A\\xfeC\"</span>\n    fmt.Println(utf8.ValidString(data2)) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints: false</span>\n}</code></pre><span id=\"OSC_h3_21\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_20\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">字符串的长度</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">让我们假设你是Python开发者，你有下面这段代码：</p><pre class=\"hljs python\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs python\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\">data = <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">u'♥'</span>  \nprint(len(data)) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">#prints: 1  </span></code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">当把它转换为Go代码时，你可能会大吃一惊。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    data := <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"♥\"</span>\n    fmt.Println(<span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">len</span>(data)) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints: 3</span>\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">内建的&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">len()</code>函数返回byte的数量，而不是像Python中计算好的unicode字符串中字符的数量。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">要在Go中得到相同的结果，可以使用“unicode/utf8”包中的&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">RuneCountInString()</code>函数。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> (  \n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"unicode/utf8\"</span>\n)\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    data := <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"♥\"</span>\n    fmt.Println(utf8.RuneCountInString(data)) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints: 1</span>\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">理论上说&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">RuneCountInString()</code>函数并不返回字符的数量，因为单个字符可能占用多个rune。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> (  \n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"unicode/utf8\"</span>\n)\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    data := <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"é\"</span>\n    fmt.Println(<span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">len</span>(data))                    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints: 3</span>\n    fmt.Println(utf8.RuneCountInString(data)) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints: 2</span>\n}</code></pre><span id=\"OSC_h3_22\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_21\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">在多行的Slice、Array和Map语句中遗漏逗号</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Fails:</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    x := []<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>{\n    <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>,\n    <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span> <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//error</span>\n    }\n    _ = x\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Compile Errors:</p><pre class=\"hljs groovy\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs groovy\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-regexp\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">/tmp/</span>sandbox367520156<span class=\"hljs-regexp\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">/main.go:6: syntax error: need trailing comma before newline in composite literal /</span>tmp<span class=\"hljs-regexp\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">/sandbox367520156/</span>main.<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">go:</span><span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">8</span>: non-declaration statement outside function body <span class=\"hljs-regexp\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">/tmp/</span>sandbox367520156/main.<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">go:</span><span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">9</span>: syntax <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">error:</span> unexpected }</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Works:</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    x := []<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>{\n    <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>,\n    <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span>,\n    }\n    x = x\n\n    y := []<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>{<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">3</span>,<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">4</span>,} <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//no error</span>\n    y = y\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">当你把声明折叠到单行时，如果你没加末尾的逗号，你将不会得到编译错误。</p><span id=\"OSC_h3_23\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_22\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">log.Fatal和log.Panic不仅仅是Log</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Logging库一般提供不同的log等级。与这些logging库不同，Go中log包在你调用它的&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">Fatal*()</code>和&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">Panic*()</code>函数时，可以做的不仅仅是log。当你的应用调用这些函数时，Go也将会终止应用 :-)</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"log\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    log.Fatalln(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"Fatal Level: log entry\"</span>) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//app exits here</span>\n    log.Println(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"Normal Level: log entry\"</span>)\n}</code></pre><span id=\"OSC_h3_24\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_23\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">内建的数据结构操作不是同步的</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">即使Go本身有很多特性来支持并发，并发安全的数据集合并不是其中之一 :-)确保数据集合以原子的方式更新是你的职责。Goroutines和channels是实现这些原子操作的推荐方式，但你也可以使用“sync”包，如果它对你的应用有意义的话。</p><span id=\"OSC_h3_25\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_24\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">String在“range”语句中的迭代值</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">索引值（“range”操作返回的第一个值）是返回的第二个值的当前“字符”（unicode编码的point/rune）的第一个byte的索引。它不是当前“字符”的索引，这与其他语言不同。注意真实的字符可能会由多个rune表示。如果你需要处理字符，确保你使用了“norm”包（golang.org/x/text/unicode/norm）。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">string变量的&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">for&nbsp;range</code>语句将会尝试把数据翻译为UTF8文本。对于它无法理解的任何byte序列，它将返回0xfffd runes（即unicode替换字符），而不是真实的数据。如果你任意（非UTF8文本）的数据保存在string变量中，确保把它们转换为byte slice，以得到所有保存的数据。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    data := <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"A\\xfe\\x02\\xff\\x04\"</span>\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> _,v := <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">range</span> data {\n        fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"%#x \"</span>,v)\n    }\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints: 0x41 0xfffd 0x2 0xfffd 0x4 (not ok)</span>\n\n    fmt.Println()\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> _,v := <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">range</span> []<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">byte</span>(data) {\n        fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"%#x \"</span>,v)\n    }\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints: 0x41 0xfe 0x2 0xff 0x4 (good)</span>\n}</code></pre><span id=\"OSC_h3_26\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_25\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">对Map使用“for range”语句迭代</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">如果你希望以某个顺序（比如，按key值排序）的方式得到元素，就需要这个技巧。每次的map迭代将会生成不同的结果。Go的runtime有心尝试随机化迭代顺序，但并不总会成功，这样你可能得到一些相同的map迭代结果。所以如果连续看到5个相同的迭代结果，不要惊讶。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    m := <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">map</span>[<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">string</span>]<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>{<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"one\"</span>:<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>,<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"two\"</span>:<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span>,<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"three\"</span>:<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">3</span>,<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"four\"</span>:<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">4</span>}\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> k,v := <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">range</span> m {\n        fmt.Println(k,v)\n    }\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">而且如果你使用Go的游乐场（https://play.golang.org/)，你将总会得到同样的结果，因为除非你修改代码，否则它不会重新编译代码。</p><span id=\"OSC_h3_27\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_26\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">\"switch\"声明中的失效行为</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">在“switch”声明语句中的“case”语句块在默认情况下会break。这和其他语言中的进入下一个“next”代码块的默认行为不同。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    isSpace := <span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">(ch </span></span><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">byte</span></span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">)</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">bool</span></span></span></span> {\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">switch</span>(ch) {\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">case</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">' '</span>: <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//error</span>\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">case</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">'\\t'</span>:\n            <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">return</span> <span class=\"hljs-literal\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 175);\">true</span>\n        }\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">return</span> <span class=\"hljs-literal\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 175);\">false</span>\n    }\n\n    fmt.Println(isSpace(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">'\\t'</span>)) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints true (ok)</span>\n    fmt.Println(isSpace(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">' '</span>))  <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints false (not ok)</span>\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">你可以通过在每个“case”块的结尾使用“fallthrough”，来强制“case”代码块进入。你也可以重写switch语句，来使用“case”块中的表达式列表。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    isSpace := <span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">(ch </span></span><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">byte</span></span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">)</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">bool</span></span></span></span> {\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">switch</span>(ch) {\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">case</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">' '</span>, <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">'\\t'</span>:\n            <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">return</span> <span class=\"hljs-literal\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 175);\">true</span>\n        }\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">return</span> <span class=\"hljs-literal\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 175);\">false</span>\n    }\n\n    fmt.Println(isSpace(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">'\\t'</span>)) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints true (ok)</span>\n    fmt.Println(isSpace(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">' '</span>))  <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints true (ok)</span>\n}</code></pre><span id=\"OSC_h3_28\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_27\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">自增和自减</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">许多语言都有自增和自减操作。不像其他语言，Go不支持前置版本的操作。你也无法在表达式中使用这两个操作符。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Fails:</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    data := []<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>{<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>,<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span>,<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">3</span>}\n    i := <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>\n    ++i <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//error</span>\n    fmt.Println(data[i++]) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//error</span>\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Compile Errors:</p><pre class=\"hljs groovy\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs groovy\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-regexp\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">/tmp/</span>sandbox101231828<span class=\"hljs-regexp\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">/main.go:8: syntax error: unexpected ++ /</span>tmp<span class=\"hljs-regexp\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">/sandbox101231828/</span>main.<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">go:</span><span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">9</span>: syntax <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">error:</span> unexpected ++, <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">expecting :</span></code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Works:</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    data := []<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>{<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>,<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span>,<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">3</span>}\n    i := <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>\n    i++\n    fmt.Println(data[i])\n}</code></pre><span id=\"OSC_h3_29\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_28\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">按位NOT操作</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">许多语言使用&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">~</code>&nbsp;作为一元的NOT操作符（即按位补足），但Go为了这个重用了XOR操作符（<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">^</code>）。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Fails:</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    fmt.Println(~<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span>) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//error</span>\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Compile Error:</p><pre class=\"hljs groovy\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs groovy\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-regexp\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">/tmp/</span>sandbox965529189/main.<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">go:</span><span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">6</span>: the bitwise complement operator is ^</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Works:</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">var</span> d <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">uint8</span> = <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span>\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"%08b\\n\"</span>,^d)\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Go依旧使用&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">^</code>作为XOR的操作符，这可能会让一些人迷惑。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">如果你愿意，你可以使用一个二元的XOR操作（如， 0x02 XOR 0xff）来表示一个一元的NOT操作（如，NOT 0x02）。这可以解释为什么&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">^</code>被重用来表示一元的NOT操作。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Go也有特殊的‘AND NOT’按位操作（&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">&amp;^</code>），这也让NOT操作更加的让人迷惑。这看起来需要特殊的特性/hack来支持&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">A AND&nbsp;(NOT B)</code>，而无需括号。</p><pre class=\"hljs perl\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs perl\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\nimport <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\nfunc main() {  \n    var a uint8 = <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0x82</span>\n    var b uint8 = <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0x02</span>\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"%08b [A]\\n\"</span>,a)\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"%08b [B]\\n\"</span>,b)\n\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"%08b (NOT B)\\n\"</span>,^b)\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"%08b ^ %08b = %08b [B XOR 0xff]\\n\"</span>,b,<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0xff</span>,b ^ <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0xff</span>)\n\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"%08b ^ %08b = %08b [A XOR B]\\n\"</span>,a,b,a ^ b)\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"%08b &amp; %08b = %08b [A AND B]\\n\"</span>,a,b,a &amp; b)\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"%08b &amp;^%08b = %08b [A 'AND NOT' B]\\n\"</span>,a,b,a &amp;^ b)\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"%08b&amp;(^%08b)= %08b [A AND (NOT B)]\\n\"</span>,a,b,a &amp; (^b))\n}</code></pre><span id=\"OSC_h3_30\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_29\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">操作优先级的差异</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">除了”bit clear“操作（&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">&amp;^</code>），Go也一个与许多其他语言共享的标准操作符的集合。尽管操作优先级并不总是一样。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"0x2 &amp; 0x2 + 0x4 -&gt; %#x\\n\"</span>,<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0x2</span> &amp; <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0x2</span> + <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0x4</span>)\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints: 0x2 &amp; 0x2 + 0x4 -&gt; 0x6</span>\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//Go:    (0x2 &amp; 0x2) + 0x4</span>\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//C++:    0x2 &amp; (0x2 + 0x4) -&gt; 0x2</span>\n\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"0x2 + 0x2 &lt;&lt; 0x1 -&gt; %#x\\n\"</span>,<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0x2</span> + <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0x2</span> &lt;&lt; <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0x1</span>)\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints: 0x2 + 0x2 &lt;&lt; 0x1 -&gt; 0x6</span>\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//Go:     0x2 + (0x2 &lt;&lt; 0x1)</span>\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//C++:   (0x2 + 0x2) &lt;&lt; 0x1 -&gt; 0x8</span>\n\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"0xf | 0x2 ^ 0x2 -&gt; %#x\\n\"</span>,<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0xf</span> | <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0x2</span> ^ <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0x2</span>)\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints: 0xf | 0x2 ^ 0x2 -&gt; 0xd</span>\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//Go:    (0xf | 0x2) ^ 0x2</span>\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//C++:    0xf | (0x2 ^ 0x2) -&gt; 0xf</span>\n}</code></pre><span id=\"OSC_h3_31\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_30\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">未导出的结构体不会被编码</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">以小写字母开头的结构体将不会被（json、xml、gob等）编码，因此当你编码这些未导出的结构体时，你将会得到零值。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">Fails:</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> (  \n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"encoding/json\"</span>\n)\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">type</span> MyData <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">struct</span> {  \n    One <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>\n    two <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">string</span>\n}\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    in := MyData{<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>,<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"two\"</span>}\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"%#v\\n\"</span>,in) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints main.MyData{One:1, two:\"two\"}</span>\n\n    encoded,_ := json.Marshal(in)\n    fmt.Println(<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">string</span>(encoded)) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints {\"One\":1}</span>\n\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">var</span> out MyData\n    json.Unmarshal(encoded,&amp;out)\n\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"%#v\\n\"</span>,out) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints main.MyData{One:1, two:\"\"}</span>\n}</code></pre><span id=\"OSC_h3_32\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_31\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">有活动的Goroutines下的应用退出</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">应用将不会得带所有的goroutines完成。这对于初学者而言是个很常见的错误。每个人都是以某个程度开始，因此如果犯了初学者的错误也没神马好丢脸的 :-)</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> (  \n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"time\"</span>\n)\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    workerCount := <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span>\n\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> i := <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>; i &lt; workerCount; i++ {\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">go</span> doit(i)\n    }\n    time.Sleep(<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span> * time.Second)\n    fmt.Println(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"all done!\"</span>)\n}\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">doit</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">(workerId </span></span><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">int</span></span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">)</span></span></span></span> {  \n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"[%v] is running\\n\"</span>,workerId)\n    time.Sleep(<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">3</span> * time.Second)\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"[%v] is done\\n\"</span>,workerId)\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">你将会看到：</p><pre class=\"hljs less\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs less\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-selector-attr\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">[0]</span> <span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">is</span> <span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">running</span>\n<span class=\"hljs-selector-attr\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">[1]</span> <span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">is</span> <span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">running</span>\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">all</span> <span class=\"hljs-selector-tag\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">done</span>!</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">一个最常见的解决方法是使用“WaitGroup”变量。它将会让主goroutine等待所有的worker goroutine完成。如果你的应用有长时运行的消息处理循环的worker，你也将需要一个方法向这些goroutine发送信号，让它们退出。你可以给各个worker发送一个“kill”消息。另一个选项是关闭一个所有worker都接收的channel。这是一次向所有goroutine发送信号的简单方式。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> (  \n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"sync\"</span>\n)\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">var</span> wg sync.WaitGroup\n    done := <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">make</span>(<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">chan</span> <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">struct</span>{})\n    workerCount := <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span>\n\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> i := <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>; i &lt; workerCount; i++ {\n        wg.Add(<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>)\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">go</span> doit(i,done,wg)\n    }\n\n    <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">close</span>(done)\n    wg.Wait()\n    fmt.Println(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"all done!\"</span>)\n}\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">doit</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">(workerId </span></span><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">int</span></span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">,done &lt;-</span></span><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">chan</span></span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span></span><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">struct</span></span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">{},wg sync.WaitGroup)</span></span></span></span> {  \n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"[%v] is running\\n\"</span>,workerId)\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">defer</span> wg.Done()\n    &lt;- done\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"[%v] is done\\n\"</span>,workerId)\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">如果你运行这个应用，你将会看到：</p><pre class=\"hljs actionscript\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs actionscript\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\">[<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>] <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">is</span> running\n[<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>] <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">is</span> done\n[<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>] <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">is</span> running\n[<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>] <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">is</span> done</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">看起来所有的worker在主goroutine退出前都完成了。棒！然而，你也将会看到这个：</p><pre class=\"hljs nginx\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs nginx\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-attribute\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 220, 188);\">fatal</span> <span class=\"hljs-literal\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 175);\">error</span>: all goroutines are asleep - deadlock!</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">这可不太好 :-) 发送了神马？为什么会出现死锁？worker退出了，它们也执行了&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">wg.Done()</code>。应用应该没问题啊。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">死锁发生是因为各个worker都得到了原始的“WaitGroup”变量的一个拷贝。当worker执行&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">wg.Done()</code>时，并没有在主goroutine上的“WaitGroup”变量上生效。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> (  \n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"sync\"</span>\n)\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">var</span> wg sync.WaitGroup\n    done := <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">make</span>(<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">chan</span> <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">struct</span>{})\n    wq := <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">make</span>(<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">chan</span> <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">interface</span>{})\n    workerCount := <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span>\n\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> i := <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>; i &lt; workerCount; i++ {\n        wg.Add(<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>)\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">go</span> doit(i,wq,done,&amp;wg)\n    }\n\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> i := <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>; i &lt; workerCount; i++ {\n        wq &lt;- i\n    }\n\n    <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">close</span>(done)\n    wg.Wait()\n    fmt.Println(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"all done!\"</span>)\n}\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">doit</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">(workerId </span></span><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">int</span></span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">, wq &lt;-</span></span><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">chan</span></span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span></span><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">interface</span></span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">{},done &lt;-</span></span><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">chan</span></span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span></span><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">struct</span></span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">{},wg *sync.WaitGroup)</span></span></span></span> {  \n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"[%v] is running\\n\"</span>,workerId)\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">defer</span> wg.Done()\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> {\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">select</span> {\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">case</span> m := &lt;- wq:\n            fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"[%v] m =&gt; %v\\n\"</span>,workerId,m)\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">case</span> &lt;- done:\n            fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"[%v] is done\\n\"</span>,workerId)\n            <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">return</span>\n        }\n    }\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">现在它会如预期般工作 :-)</p><span id=\"OSC_h3_33\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_32\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">向无缓存的Channel发送消息，只要目标接收者准备好就会立即返回</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">发送者将不会被阻塞，除非消息正在被接收者处理。根据你运行代码的机器的不同，接收者的goroutine可能会或者不会有足够的时间，在发送者继续执行前处理消息。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    ch := <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">make</span>(<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">chan</span> <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">string</span>)\n\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">go</span> <span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> m := <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">range</span> ch {\n            fmt.Println(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"processed:\"</span>,m)\n        }\n    }()\n\n    ch &lt;- <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"cmd.1\"</span>\n    ch &lt;- <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"cmd.2\"</span> <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//won't be processed</span>\n}</code></pre><span id=\"OSC_h3_34\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_33\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">向已关闭的Channel发送会引起Panic</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">从一个关闭的channel接收是安全的。在接收状态下的&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">ok</code>的返回值将被设置为&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">false</code>，这意味着没有数据被接收。如果你从一个有缓存的channel接收，你将会首先得到缓存的数据，一旦它为空，返回的&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">ok</code>值将变为&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">false</code>。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">向关闭的channel中发送数据会引起panic。这个行为有文档说明，但对于新的Go开发者的直觉不同，他们可能希望发送行为与接收行为很像。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> (  \n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"time\"</span>\n)\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    ch := <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">make</span>(<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">chan</span> <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>)\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> i := <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>; i &lt; <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">3</span>; i++ {\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">go</span> <span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">(idx </span></span><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">int</span></span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">)</span></span></span></span> {\n            ch &lt;- (idx + <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>) * <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span>\n        }(i)\n    }\n\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//get the first result</span>\n    fmt.Println(&lt;-ch)\n    <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">close</span>(ch) <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//not ok (you still have other senders)</span>\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//do other work</span>\n    time.Sleep(<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span> * time.Second)\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">根据不同的应用，修复方法也将不同。可能是很小的代码修改，也可能需要修改应用的设计。无论是哪种方法，你都需要确保你的应用不会向关闭的channel中发送数据。</p><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">上面那个有bug的例子可以通过使用一个特殊的废弃的channel来向剩余的worker发送不再需要它们的结果的信号来修复。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> (  \n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"time\"</span>\n)\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    ch := <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">make</span>(<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">chan</span> <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>)\n    done := <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">make</span>(<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">chan</span> <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">struct</span>{})\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> i := <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>; i &lt; <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">3</span>; i++ {\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">go</span> <span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">(idx </span></span><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">int</span></span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">)</span></span></span></span> {\n            <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">select</span> {\n            <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">case</span> ch &lt;- (idx + <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>) * <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span>: fmt.Println(idx,<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"sent result\"</span>)\n            <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">case</span> &lt;- done: fmt.Println(idx,<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"exiting\"</span>)\n            }\n        }(i)\n    }\n\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//get first result</span>\n    fmt.Println(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"result:\"</span>,&lt;-ch)\n    <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">close</span>(done)\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//do other work</span>\n    time.Sleep(<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">3</span> * time.Second)\n}</code></pre><span id=\"OSC_h3_35\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_34\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">使用\"nil\" Channels</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">在一个&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">nil</code>的channel上发送和接收操作会被永久阻塞。这个行为有详细的文档解释，但它对于新的Go开发者而言是个惊喜。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> (  \n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n    <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"time\"</span>\n)\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">var</span> ch <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">chan</span> <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> i := <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>; i &lt; <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">3</span>; i++ {\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">go</span> <span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">(idx </span></span><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">int</span></span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">)</span></span></span></span> {\n            ch &lt;- (idx + <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>) * <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span>\n        }(i)\n    }\n\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//get first result</span>\n    fmt.Println(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"result:\"</span>,&lt;-ch)\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//do other work</span>\n    time.Sleep(<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span> * time.Second)\n}</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">如果运行代码你将会看到一个runtime错误：</p><pre class=\"hljs nginx\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs nginx\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-attribute\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 220, 188);\">fatal</span> <span class=\"hljs-literal\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 175);\">error</span>: all goroutines are asleep - deadlock!</code></pre><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">这个行为可以在&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">select</code>声明中用于动态开启和关闭&nbsp;<code style=\"box-sizing: inherit; padding: 2px; font-size: 13px;\">case</code>代码块的方法。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>  \n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"time\"</span>\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    inch := <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">make</span>(<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">chan</span> <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>)\n    outch := <span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">make</span>(<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">chan</span> <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>)\n\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">go</span> <span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">var</span> in &lt;- <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">chan</span> <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span> = inch\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">var</span> out <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">chan</span> &lt;- <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">var</span> val <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> {\n           <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">select</span> {\n            <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">case</span> out &lt;- val:\n                out = <span class=\"hljs-literal\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 175);\">nil</span>\n                in = inch\n            <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">case</span> val = &lt;- in:\n                out = outch\n                in = <span class=\"hljs-literal\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 175);\">nil</span>\n            }\n        }\n    }()\n\n    <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">go</span> <span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {\n        <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">for</span> r := <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">range</span> outch {\n            fmt.Println(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"result:\"</span>,r)\n        }\n    }()\n\n    time.Sleep(<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">0</span>)\n    inch &lt;- <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>\n    inch &lt;- <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">2</span>\n    time.Sleep(<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">3</span> * time.Second)\n}</code></pre><span id=\"OSC_h3_36\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"></span><h3 id=\"h3_35\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; font-size: 18px; font-weight: 500;\">传值方法的接收者无法修改原有的值</h3><ul style=\"box-sizing: inherit; padding: 8px 15px; margin: 0px 0px 0px 30px;\"><li style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; padding: 0px; margin: 0px;\">level: beginner</li></ul><p style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; margin-bottom: 16px;\">方法的接收者就像常规的函数参数。如果声明为值，那么你的函数/方法得到的是接收者参数的拷贝。这意味着对接收者所做的修改将不会影响原有的值，除非接收者是一个map或者slice变量，而你更新了集合中的元素，或者你更新的域的接收者是指针。</p><pre class=\"hljs go\" style=\"box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; background-position: initial initial; background-repeat: initial initial;\"><code class=\"hljs go\" style=\"box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; background-color: rgb(63, 63, 63); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-size: 13px; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">package</span> main\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">import</span> <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"fmt\"</span>\n\n<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">type</span> data <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">struct</span> {  \n    num <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">int</span>\n    key *<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">string</span>\n    items <span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">map</span>[<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">string</span>]<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">bool</span>\n}\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">(this *data)</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">pmethod</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    this.num = <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">7</span>\n}\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">(this data)</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">vmethod</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    this.num = <span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">8</span>\n    *this.key = <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"v.key\"</span>\n    this.items[<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"vmethod\"</span>] = <span class=\"hljs-literal\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 175);\">true</span>\n}\n\n<span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-keyword\" style=\"box-sizing: inherit;\">func</span></span></span><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"> </span><span class=\"hljs-title\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(239, 239, 143);\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-title\" style=\"box-sizing: inherit;\">main</span></span></span><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-function\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\"><span class=\"hljs-params\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent;\">()</span></span></span></span> {  \n    key := <span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"key.1\"</span>\n    d := data{<span class=\"hljs-number\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(140, 208, 211);\">1</span>,&amp;key,<span class=\"hljs-built_in\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">make</span>(<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">map</span>[<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">string</span>]<span class=\"hljs-keyword\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(227, 206, 171);\">bool</span>)}\n\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"num=%v key=%v items=%v\\n\"</span>,d.num,*d.key,d.items)\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints num=1 key=key.1 items=map[]</span>\n\n    d.pmethod()\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"num=%v key=%v items=%v\\n\"</span>,d.num,*d.key,d.items)\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints num=7 key=key.1 items=map[]</span>\n\n    d.vmethod()\n    fmt.Printf(<span class=\"hljs-string\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(204, 147, 147);\">\"num=%v key=%v items=%v\\n\"</span>,d.num,*d.key,d.items)\n    <span class=\"hljs-comment\" style=\"box-sizing: inherit; -webkit-tap-highlight-color: transparent; color: rgb(127, 159, 127);\">//prints num=7 key=v.key items=map[vmethod:true]</span>\n}</code></pre></div></div><div class=\"blog-opr\" style=\"box-sizing: inherit; text-align: right; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(204, 204, 204); padding-bottom: 17px; font-size: 16px; font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(248, 248, 248);\"></div>"
    }
  ]
}