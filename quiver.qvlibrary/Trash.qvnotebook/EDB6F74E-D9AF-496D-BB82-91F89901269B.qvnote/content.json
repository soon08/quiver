{
  "title": "IOS9网络请求默认被屏蔽",
  "cells": [
    {
      "type": "text",
      "data": "<h3>网络请求报错。</h3>\n<p>升级Xcode 7.0发现网络访问失败。<br>输出错误信息<br><code>#warning: 获取app配置信息失败: The resource could not be loaded because the App Transport Security policy requires the use of a secure connection.</code><br>原因：iOS9引入了新特性App Transport Security (ATS)。<br>详情：App Transport Security (ATS)<br>新特性要求App内访问的网络必须使用HTTPS协议。<br>但是现在公司的项目使用的是HTTP协议，使用私有加密方式保证数据安全。现在也不能马上改成HTTPS协议传输。<br>最终找到以下解决办法：<br><code>在Info.plist中添加NSAppTransportSecurity类型Dictionary。\n在NSAppTransportSecurity下添加NSAllowsArbitraryLoads类型Boolean,值设为YES</code></p>\n<div class=\"image-package imagebubble\" widget=\"ImageBubble\">\n<img src=\"quiver-image-url/09DC5DA459C4FE889A56CB7679A6EB20.png\" data-original-src=\"http://upload-images.jianshu.io/upload_images/277529-94d1679c2b8caeb5.png?imageMogr2/auto-orient/strip%7CimageView2/2\" class=\"imagebubble-image\"><br><div class=\"image-caption\">2F5721B6-2C74-4B59-84B3-7D77C541038F.png</div>\n</div>\n<h3>Bitcode问题</h3>\n<p>原因：Xcode7 及以上版本会默认开启 bitcode 。<br>bitcode具体是什么就不解释了。<br>解决方法：<br>1.更新library使包含Bitcode，否则会出现以上的警告。<br>2.关闭Bitcode，简单粗暴。</p>\n<p><code>Build Settings”-&gt;”Enable Bitcode”改成\"NO\"。</code><br></p><div class=\"image-package imagebubble\" widget=\"ImageBubble\">\n<img src=\"quiver-image-url/954F7ABCECC6616811C880141E9F3105.jpg\" data-original-src=\"http://upload-images.jianshu.io/upload_images/277529-9ae355cc91055286.jpg?imageMogr2/auto-orient/strip%7CimageView2/2\" class=\"imagebubble-image\"><br><div class=\"image-caption\">20150917113544983.jpg</div>\n</div>\n<h3>项目运行报错如下</h3>\n<p> <code>&lt;Error&gt;: CGContextSaveGState: invalid context 0x0. If you want to see the backtrace, please set CG_CONTEXT_SHOW_BACKTRACE environmental variable.</code><br><code>&lt;Error&gt;: CGContextTranslateCTM: invalid context 0x0. If you want to see the backtrace, please set CG_CONTEXT_SHOW_BACKTRACE environmental variable.</code><br><code>&lt;Error&gt;: CGContextRestoreGState: invalid context 0x0. If you want to see the backtrace, please set CG_CONTEXT_SHOW_BACKTRACE environmental variable.</code><br>出错原因：设置app的状态栏样式的使用使用了旧的方式，在info.plist里面设置了View controller-based status bar appearance为NO，默认为YES，一般式iOS6的时候使用这种方式，iOS7，8也兼容，但是到了iOS9就报了警告。</p>\n<p>解决办法：</p>\n<p>删除 原先的设置代码<br><code>//设置状态栏的白色\n    [[UIApplication sharedApplication] setStatusBarStyle:UIStatusBarStyleLightContent];</code></p>\n<p>修改方式将View controller-based status bar appearance设置为YES，然后使用新的方式来实现状态栏的样式。</p>\n<div class=\"image-package imagebubble\" widget=\"ImageBubble\">\n<img src=\"quiver-image-url/92F6406AD0381ABA59F5C4B2C4D19F8B.png\" data-original-src=\"http://upload-images.jianshu.io/upload_images/277529-11f3fef3ecff0a0e.png?imageMogr2/auto-orient/strip%7CimageView2/2\" class=\"imagebubble-image\"><br><div class=\"image-caption\">2F5721B6-2C74-4B59-84B3-7D77C541038F.png</div>\n</div>\n<p>在你的 自定义导航控制器里面 写上如下方法:<br>//设置状态栏的（亮色）白色<br><code>-(UIStatusBarStyle)preferredStatusBarStyle\n{\n    return UIStatusBarStyleLightContent;\n}</code><br>记住要clean 或者删除应用程序 重新运行</p>\n<h3>升级Xcode 7 之后 ios 9 模拟器 一启动程序 就直接报错</h3>\n<p>报错如下<br><code>***** Assertion failure in -[UIApplication _runWithMainScene:transitionContext:completion:], /BuildRoot/Library/Caches/com.apple.xbs/Sources/UIKit_Sim/UIKit-3505.16/UIApplication.m:3294**</code></p>\n<p>原因：</p>\n<p>新的SDK不允许在设置rootViewController之前做过于复杂的操作，导致在didFinishLaunchingWithOptions 结束后还没有设置rootViewController<br> Xcode7需要所有UIWindow必须立即先设置一个rootViewController</p>\n<p>解决办法:<br>先设置个rootVIewController 之后重新赋值<br><code>UIWindow *window = [[UIWindowalloc] initWithFrame:[UIScreenmainScreen].bounds];\nwindow.rootViewController = [UIViewController new];</code></p><br><br><div>文／_会飞的鱼（简书作者）<br>原文链接：http://www.jianshu.com/p/4dd5773270f4<br>著作权归作者所有，转载请联系作者获得授权，并标注“简书作者”。</div>"
    }
  ]
}