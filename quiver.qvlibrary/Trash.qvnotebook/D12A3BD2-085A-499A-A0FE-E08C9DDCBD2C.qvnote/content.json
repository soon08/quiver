{
  "title": "Naemon文档",
  "cells": [
    {
      "type": "text",
      "data": "<div><pre style=\"background-color:#ffffff;color:#000000;font-family:'Menlo';font-size:13.5pt;\"><span style=\"color:#000080;font-weight:bold;\">var </span><span style=\"color:#f90500;font-weight:bold;font-style:italic;\">path </span>= <span style=\"font-weight:bold;\">require</span>(<span style=\"color:#008000;font-weight:bold;\">'path'</span>);<br><span style=\"color:#000080;font-weight:bold;\">var </span><span style=\"color:#f90500;font-weight:bold;font-style:italic;\">Naemon </span>= <span style=\"font-weight:bold;\">require</span>(<span style=\"color:#008000;font-weight:bold;\">'naemon'</span>);<br><span style=\"color:#000080;font-weight:bold;\">var </span><span style=\"color:#f90500;font-weight:bold;font-style:italic;\">daemon </span>= <span style=\"color:#000080;font-weight:bold;\">new </span><span style=\"color:#f90500;font-weight:bold;font-style:italic;\">Naemon</span>();<br><br><span style=\"color:#000080;font-weight:bold;\">var </span><span style=\"color:#f90500;font-weight:bold;font-style:italic;\">scriptPath </span>= <span style=\"color:#f90500;font-weight:bold;font-style:italic;\">path</span>.<span style=\"color:#7a0019;font-weight:bold;\">join</span>(DIR_NAME, <span style=\"color:#008000;font-weight:bold;\">'./lib/agent.js'</span>); <span style=\"color:#808080;font-style:italic;\">//child script path<br></span><span style=\"color:#000080;font-weight:bold;\">var </span><span style=\"color:#f90500;font-weight:bold;font-style:italic;\">args </span>= [<span style=\"color:#0000ff;\">1</span>,<span style=\"color:#0000ff;\">2</span>,<span style=\"color:#0000ff;\">3</span>]; <span style=\"color:#808080;font-style:italic;\">//args will be send to child process<br></span><span style=\"color:#808080;font-style:italic;\"><br></span><span style=\"color:#f90500;font-weight:bold;font-style:italic;\">daemon</span>.<span style=\"color:#7a0019;font-weight:bold;\">start</span>(<span style=\"color:#f90500;font-weight:bold;font-style:italic;\">scriptPath</span>, <span style=\"color:#f90500;font-weight:bold;font-style:italic;\">args</span>); <span style=\"color:#808080;font-style:italic;\">//start Child with damon<br></span><span style=\"color:#808080;font-style:italic;\"><br></span><span style=\"color:#808080;font-style:italic;\">//if child process send message , this function will be callback<br></span><span style=\"color:#f90500;font-weight:bold;font-style:italic;\">daemon</span>.<span style=\"color:#7a0019;font-weight:bold;\">receive</span>(<span style=\"color:#f90500;font-weight:bold;font-style:italic;\">scriptPath</span>, <span style=\"color:#000080;font-weight:bold;\">function</span>(<span style=\"font-weight:bold;font-style:italic;\">message</span>){<br>    <span style=\"color:#f90500;font-weight:bold;font-style:italic;\">console</span>.<span style=\"color:#7a0019;font-weight:bold;\">log</span>(<span style=\"font-weight:bold;font-style:italic;\">message</span>);<br>});<br><br><span style=\"color:#808080;font-style:italic;\">//receive all child process message <br></span><span style=\"color:#f90500;font-weight:bold;font-style:italic;\">daemon</span>.<span style=\"color:#7a0019;font-weight:bold;\">receive</span>(<span style=\"color:#000080;font-weight:bold;\">function</span>(<span style=\"font-weight:bold;font-style:italic;\">message</span>){<br>    <span style=\"color:#f90500;font-weight:bold;font-style:italic;\">console</span>.<span style=\"color:#7a0019;font-weight:bold;\">log</span>(<span style=\"font-weight:bold;font-style:italic;\">message</span>);<br>});<br><br><span style=\"color:#808080;font-style:italic;\">//send message to child process which's path == scriptPath <br></span><span style=\"color:#f90500;font-weight:bold;font-style:italic;\">daemon</span>.<span style=\"color:#7a0019;font-weight:bold;\">message</span>(<span style=\"color:#f90500;font-weight:bold;font-style:italic;\">scriptPath</span>, { <span style=\"color:#7a0019;font-weight:bold;\">time </span>: Date.<span style=\"color:#7a0019;font-weight:bold;\">now</span>() });<br><br><span style=\"color:#808080;font-style:italic;\">//send message to all child process which is daemoned by this daemon<br></span><span style=\"color:#f90500;font-weight:bold;font-style:italic;\">daemon</span>.<span style=\"color:#7a0019;font-weight:bold;\">message</span>({ <span style=\"color:#7a0019;font-weight:bold;\">time </span>: Date.<span style=\"color:#7a0019;font-weight:bold;\">now</span>() });<br><br><span style=\"color:#808080;font-style:italic;\">//stop<br></span><span style=\"color:#f90500;font-weight:bold;font-style:italic;\">daemon</span>.<span style=\"color:#7a0019;font-weight:bold;\">stop</span>(<span style=\"color:#f90500;font-weight:bold;font-style:italic;\">scriptPath</span>);<br><span style=\"color:#808080;font-style:italic;\">//daemon.stop(); //this will stop all child process start by this daemon</span></pre></div>"
    }
  ]
}