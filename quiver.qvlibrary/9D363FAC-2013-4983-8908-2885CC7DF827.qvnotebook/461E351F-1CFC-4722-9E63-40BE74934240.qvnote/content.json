{
  "title": "linux磁盘操作",
  "cells": [
    {
      "type": "text",
      "data": "<ul><li>fdisk -l &nbsp;&lt;<span style=\"font-family: tahoma, 宋体; font-size: 14px; line-height: 22.4px; text-align: justify; widows: 1; background-color: rgb(250, 250, 252);\">/dev/sda</span>&gt;查询当前系统的数据盘&nbsp;</li><li>fdisk /dev/xvdb 对磁盘进行分区</li></ul>"
    },
    {
      "type": "text",
      "data": "<b>fdisk 对磁盘分区</b><div><p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">Command action</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; a &nbsp; toggle a bootable flag 设定硬盘启动区</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; b &nbsp; edit bsd disklabel</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; c &nbsp; toggle the dos compatibility flag</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; d &nbsp; delete a partition 删除硬盘分割</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; l &nbsp; list known partition types</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; m &nbsp; print this menu</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; n &nbsp; add a new partition 设定新的硬盘分割区</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; o &nbsp; create a new empty DOS partition table</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; p &nbsp; print the partition table 显示分隔情况</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; q &nbsp; quit without saving changes</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; s &nbsp; create a new empty Sun disklabel</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; t &nbsp; change a partition's system id 改变硬盘分割属性</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; u &nbsp; change display/entry units</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; v &nbsp; verify the partition table</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; w &nbsp; write table to disk and exit 结束并分割硬盘分割区属性</font></p>\n<p style=\"margin: 0px; line-height: normal;\"><font face=\"Menlo\">&nbsp;&nbsp; x &nbsp; extra functionality (experts only)</font></p></div>"
    },
    {
      "type": "text",
      "data": "<b>mkfs 格式化&nbsp;<span style=\"color: rgb(0, 0, 0); font-family: STHeiti; widows: 1; background-color: rgb(255, 255, 255);\">mkfs [-V] [-t fstype] [fs-options] filesys [block]&nbsp;</span></b><div><div style=\"widows: 1;\"><ul><li><font color=\"#000000\" face=\"STHeiti\">-V 显示详细信息</font></li><li><font color=\"#000000\" face=\"STHeiti\">-t 给定档案类型，linux预设为ext2</font></li><li><font color=\"#000000\" face=\"STHeiti\">-c 在制作档案系统前，检测该partition是否有坏轨</font></li><li><font color=\"#000000\" face=\"STHeiti\">-l bad_blocks_file 将有坏轨的资料添加到</font><span style=\"color: rgb(0, 0, 0); font-family: STHeiti;\">bad_blocks_file</span></li><li><span style=\"color: rgb(0, 0, 0); font-family: STHeiti;\"><span style=\"background-color: rgb(255, 255, 255);\">-b size 指定block大小</span><br></span></li></ul><div><font color=\"#000000\" face=\"STHeiti\">注意：mkfs.ext3 等价于 mkfs -t ext3</font></div></div><div><br></div></div>"
    },
    {
      "type": "text",
      "data": "<b><span style=\"color: rgb(42, 42, 42); font-family: 'Segoe UI', Tahoma, Arial, sans-serif; line-height: 25px; text-indent: 28px; widows: 1; background-color: rgb(245, 250, 255);\">mount&nbsp;</span><span style=\"color: rgb(102, 102, 102); font-family: Arial; line-height: normal; widows: 1; background-color: rgb(255, 255, 255);\">mount [-t vfstype] [-o options] device dir&nbsp;</span></b><div><div style=\"widows: 1;\"><font color=\"#666666\" face=\"Arial\"><span style=\"background-color: rgb(255, 255, 255);\"><b>&nbsp; &nbsp; 可挂载的统称为IO设备（光盘）</b></span></font></div><div><ul><li><font color=\"#2a2a2a\" face=\"Segoe UI, Tahoma, Arial, sans-serif\"><span style=\"font-size: 14px;\">-t 指定文件系统类型，通常不需要指定，命令会自动判定</span></font></li><li><font color=\"#2a2a2a\" face=\"Segoe UI, Tahoma, Arial, sans-serif\"><span style=\"font-size: 14px;\">device 要挂接的设备</span></font></li><li><font color=\"#2a2a2a\" face=\"Segoe UI, Tahoma, Arial, sans-serif\"><span style=\"font-size: 14px;\">dir 设备在系统上的挂接点</span></font></li></ul></div></div>"
    },
    {
      "type": "text",
      "data": "<span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; line-height: 22.4px; widows: 1; background-color: rgb(255, 255, 255);\"><b>umount卸载磁盘：</b></span><div><ul><li><font color=\"#000000\" face=\"Hiragino Sans GB W3, Hiragino Sans GB, Arial, Helvetica, simsun, u5b8bu4f53\"><span style=\"font-size: 14px;\"><br></span></font></li></ul></div>"
    },
    {
      "type": "text",
      "data": "<b>df 查看磁盘使用情况</b><div><ul><li>df -f</li></ul></div>"
    },
    {
      "type": "text",
      "data": "<b>resize2fs</b><div><span style=\"font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 18px; widows: 1; background-color: rgb(255, 255, 255);\">使用resize2fs调整ext4分区大小</span></div><div><span style=\"font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; widows: 1; background-color: rgb(255, 255, 255);\"><font size=\"4\">&nbsp; &nbsp; </font></span><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">安装公司samba服务器时对磁盘需求量估计不足，原本分的只有100GB，使用一段时间后磁盘就达到了 86%的使用量，</span><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">这都什么人啊用这么大量的磁盘。。。。现在又不想重新格式化磁盘，通过google找到了无损调整磁盘分区大小的方法。 现记录如下，以备后用。&nbsp;</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; 我的情况 &nbsp;将一块硬盘分成了两个区，一个100GB 一个60GB &nbsp;，只使用了前100GB空间的内容，后面的分区没有挂载，也没有使用。属于比较好处理的情况</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">我的步骤：</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">1、umount 掉sdb磁盘 &nbsp; &nbsp;若提示磁盘忙的话请使用fuser &nbsp;命令将正在使用磁盘的程序kill掉。&nbsp;</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">2、使用 fdisk &nbsp;/dev/sdb 命令调整分区大小 &nbsp; 进去后先使用p命令查看磁柱号 ，切记用笔记下来 ~~~ 别说我没有提醒你哦。。</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">3、删除掉这你需要变化的分区和需要借用的分区（意思就是准备变大的分区及准备变小的分区）然后再使用n命令建立分区，注意开始的磁柱号要和原来的一致，结束的磁柱号可以是你期望的磁柱号。。不知道的就输入你想要的磁盘大小即可 如+150GB &nbsp;</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">4、建立需要调整的分区（借用的）。</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">5、使用保存分区表。&nbsp;</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">6、使用e2fsck &nbsp;-f &nbsp; &nbsp;/dev/sdb1 &nbsp; &nbsp; \\\\ 需要调整的分区 &nbsp;</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\"><br></span></div><div><b style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">e2fsck&nbsp;</b><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\"><br></span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">[root@localhost 桌面]# e2fsck -f  /dev/sdb1</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">第一步: 检查inode,块,和大小</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">第二步: 检查目录结构</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">第3步: 检查目录连接性</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">Pass 4: Checking reference counts</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">第5步: 检查簇概要信息</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">/dev/sdb1: 5496/6111232 files (1.8% non-contiguous), 18781569/24416784 blocks</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">7、最后再使用&nbsp;</span><span style=\"color: rgb(0, 0, 0); font-size: 14px; widows: 1; background-color: rgb(255, 255, 255); font-family: monospace; line-height: 28px; white-space: pre;\">resize2fs /dev/sdb1   调整分区大小。</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">[root@BIGDATA 桌面]# resize2fs /dev/sdb1&nbsp;</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">resize2fs 1.41.12 (17-May-2010)</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">Resizing the filesystem on /dev/sdb1 to 36622167 (4k) blocks.</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">The filesystem on /dev/sdb1 is now 36622167 blocks long.</span></div><div><span style=\"color: rgb(0, 0, 0); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 14px; widows: 1; background-color: rgb(255, 255, 255);\">8、再mount一个磁盘分区，看看是不是变大了呢 。</span></div>"
    }
  ]
}